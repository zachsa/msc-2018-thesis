\section{CouchDB}
\subsection{\textit{MapReduce} contract}
\label{couchdb-mapreduce-contracts}
\begin{minted}{javascript}
/**
 * Map function
 * @param  {Object} doc Each document in the database is passed in turn to the function
 * @return {null} Nothing is returned - key:value pairs are emitted (multiple pairs can be emitted per document)
 */
function(doc) {
    emit(someKey, someValue);
};

/**
 * Reduce function (javascript implementation of the _sum function shown)
 * @param  {Object[]} [keys] A list of [key, docId] pairs - key as from the map function, and key from the original doc
 * @param  {Object[]} values Output from the map function, or from the reduce function
 * @param  {Boolean} [rereduce] Indicates whether values are output from the map (rereduce = false) or reduce (rereduce = true) function
 * @return {[type]}
 */
function(keys, values, rereduce) {
    if (rereduce) {
        return values.reduce(function(a,b) {
            return a + b;
        }, 0);
    } else {
        return values.length;
    };
};
\end{minted}

\subsection{Sample Design Document}
\label{couchdb-design-doc-sample}
\begin{minted}{json}
{
    "_id": "_design/sample",
    "_rev": "xxxxx",
    "language": "javascript",
    "views": {
        "view1": {
            "map": "function(doc) { ... }",
            "reduce": "function(keys, values, rereduce) { ... }"
        },
        "view2": {
            "map": "function(doc) { ... }",
            "reduce": "_stats"            
        }
    },
    "shows": {
        "show1": "function(doc, req) { ... }",
        "show2": "function(doc, req) { ... }"
    },
    "lists": {
        "listFunc1": "function(head, req) { ... };",
        "listFunc2": "function(head, req) { ... };"
    },
    "updates": {
        "update1": "function(doc, req) { ... }",
        "update2": "function(doc, req) { ... }"
    },
    "filters": {
        "filter1": "function(doc, req) { ... }",
        "filter2": "function(doc, req) { ... }"
    },
    "validate_doc_update": "function(newDoc, oldDoc, userCtx, secObj) { ... }"
}
\end{minted}

\subsection{Map functions}
\subsubsection{Result 1}
\label{result-1-map}
\begin{minted}{json}
\end{minted}
\label{result-1-list}
\begin{minted}{json}
\end{minted}

\subsubsection{Result 2}
\label{result-2-map}
\begin{minted}{json}
\end{minted}
\label{result-2-list}
\begin{minted}{json}
\end{minted}

\subsubsection{Result 3}
\label{result-3-map}
\begin{minted}{json}
\end{minted}
\label{result-3-list}
\begin{minted}{json}
\end{minted}

\subsubsection{Result 4}
\label{result-4-map}
\begin{minted}{json}
\end{minted}
\label{result-4-list}
\begin{minted}{json}
\end{minted}
