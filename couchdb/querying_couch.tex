\subsection{Queries in CouchDB}

CouchDB uses the concept of "Design" documents that are, like any other CouchDB document, JSON strings. But these documents are treated as interfaces to the server process allow for users to define and execute certain functions. The entire list of functions that users are allowed to define are:

\begin{enumerate}
    \item View Functions
    \item Show Functions
    \item List Functions
    \item Update Functions
    \item Filter Functions
    \item Validate Document Update Functions
\end{enumerate}

For the purpose of this project only \textit{view functions} (The CouchDB MapReduce API), and \textit{list functions} will be discussed. List functions fall under the category of \textit{CouchApps} that as mentioned previously are likely to be excluded from future releases. These functions iterate a view output to an HTTP(S) client, allowing a final phase of transformation - i.e. a data format switch from JSON documents to CSV format. Since \textit{list functions} form part of the HTTP API, these functions effectively allow for "insta-APIs" available to the world - a useful feature and will be discussed later.

\textit{View functions} comprise \textit{Map} and \textit{Reduce} functions. These functions have the form:

\begin{figure}[h]
    \centering
    \begin{minted}{javascript} 

        /**
         * Map function
         * @param  {Object} doc Each document in the database is passed in turn to the function
         * @return {null} Nothing is returned - key:value pairs are emitted (multiple pairs can be emitted per document)
         */
        function(doc) {
            emit(someKey, someValue);
        };

        /**
         * Reduce function
         * @param  {Object[]} [keys] A list of [key, docId] pairs - key as from the map function, and key from the original doc
         * @param  {Object[]} values Output from the map function, or from the reduce function
         * @param  {Boolean} [rereduce] Indicates whether values are output from the map (rereduce = false) or reduce (rereduce = true) function
         * @return {[type]}
         */
        function(keys, values, rereduce) {
            return // ...someValue
        };
    \end{minted}
    \caption[test1]{test2}
    \label{couchmapreduce}
\end{figure}
